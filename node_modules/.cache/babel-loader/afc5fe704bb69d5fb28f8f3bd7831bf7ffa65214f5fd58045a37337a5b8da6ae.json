{"ast":null,"code":"var _jsxFileName = \"E:\\\\react\\\\mui-react-redux-toolkit-crud\\\\src\\\\app\\\\contexts\\\\JWTAuthContext.js\",\n  _s = $RefreshSig$();\nimport { createContext, useEffect, useReducer } from \"react\";\nimport axios from \"axios\";\n// CUSTOM COMPONENT\nimport { MatxLoading } from \"app/components\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  user: null,\n  isInitialized: false,\n  isAuthenticated: false\n};\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case \"INIT\":\n      {\n        const {\n          isAuthenticated,\n          user\n        } = action.payload;\n        return {\n          ...state,\n          isAuthenticated,\n          isInitialized: true,\n          user\n        };\n      }\n    case \"LOGIN\":\n      {\n        return {\n          ...state,\n          isAuthenticated: true,\n          user: action.payload.user\n        };\n      }\n    case \"LOGOUT\":\n      {\n        return {\n          ...state,\n          isAuthenticated: false,\n          user: null\n        };\n      }\n    case \"REGISTER\":\n      {\n        const {\n          user\n        } = action.payload;\n        return {\n          ...state,\n          isAuthenticated: true,\n          user\n        };\n      }\n    default:\n      return state;\n  }\n};\nconst AuthContext = /*#__PURE__*/createContext({\n  ...initialState,\n  method: \"JWT\",\n  login: () => {},\n  logout: () => {},\n  register: () => {}\n});\nexport const AuthProvider = ({\n  children\n}) => {\n  _s();\n  const [state, dispatch] = useReducer(reducer, initialState);\n  const login = async (email, password) => {\n    const response = await axios.post(\"/api/auth/login\", {\n      email,\n      password\n    });\n    const {\n      user\n    } = response.data;\n    dispatch({\n      type: \"LOGIN\",\n      payload: {\n        user\n      }\n    });\n  };\n  const register = async (email, username, password) => {\n    const response = await axios.post(\"/api/auth/register\", {\n      email,\n      username,\n      password\n    });\n    const {\n      user\n    } = response.data;\n    dispatch({\n      type: \"REGISTER\",\n      payload: {\n        user\n      }\n    });\n  };\n  const logout = () => {\n    dispatch({\n      type: \"LOGOUT\"\n    });\n  };\n  useEffect(() => {\n    (async () => {\n      try {\n        const {\n          data\n        } = await axios.get(\"/api/auth/profile\");\n        dispatch({\n          type: \"INIT\",\n          payload: {\n            isAuthenticated: true,\n            user: data.user\n          }\n        });\n      } catch (err) {\n        console.error(err);\n        dispatch({\n          type: \"INIT\",\n          payload: {\n            isAuthenticated: false,\n            user: null\n          }\n        });\n      }\n    })();\n  }, []);\n\n  // SHOW LOADER\n  if (!state.isInitialized) return /*#__PURE__*/_jsxDEV(MatxLoading, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 36\n  }, this);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      ...state,\n      method: \"JWT\",\n      login,\n      logout,\n      register\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 5\n  }, this);\n};\n_s(AuthProvider, \"bgCdjuTOmPdSBRwTap80EFd9Y3U=\");\n_c = AuthProvider;\nexport default AuthContext;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["createContext","useEffect","useReducer","axios","MatxLoading","jsxDEV","_jsxDEV","initialState","user","isInitialized","isAuthenticated","reducer","state","action","type","payload","AuthContext","method","login","logout","register","AuthProvider","children","_s","dispatch","email","password","response","post","data","username","get","err","console","error","fileName","_jsxFileName","lineNumber","columnNumber","Provider","value","_c","$RefreshReg$"],"sources":["E:/react/mui-react-redux-toolkit-crud/src/app/contexts/JWTAuthContext.js"],"sourcesContent":["import { createContext, useEffect, useReducer } from \"react\";\nimport axios from \"axios\";\n// CUSTOM COMPONENT\nimport { MatxLoading } from \"app/components\";\n\nconst initialState = {\n  user: null,\n  isInitialized: false,\n  isAuthenticated: false\n};\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case \"INIT\": {\n      const { isAuthenticated, user } = action.payload;\n      return { ...state, isAuthenticated, isInitialized: true, user };\n    }\n\n    case \"LOGIN\": {\n      return { ...state, isAuthenticated: true, user: action.payload.user };\n    }\n\n    case \"LOGOUT\": {\n      return { ...state, isAuthenticated: false, user: null };\n    }\n\n    case \"REGISTER\": {\n      const { user } = action.payload;\n\n      return { ...state, isAuthenticated: true, user };\n    }\n\n    default:\n      return state;\n  }\n};\n\nconst AuthContext = createContext({\n  ...initialState,\n  method: \"JWT\",\n  login: () => {},\n  logout: () => {},\n  register: () => {}\n});\n\nexport const AuthProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(reducer, initialState);\n\n  const login = async (email, password) => {\n    const response = await axios.post(\"/api/auth/login\", { email, password });\n    const { user } = response.data;\n\n    dispatch({ type: \"LOGIN\", payload: { user } });\n  };\n\n  const register = async (email, username, password) => {\n    const response = await axios.post(\"/api/auth/register\", { email, username, password });\n    const { user } = response.data;\n\n    dispatch({ type: \"REGISTER\", payload: { user } });\n  };\n\n  const logout = () => {\n    dispatch({ type: \"LOGOUT\" });\n  };\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const { data } = await axios.get(\"/api/auth/profile\");\n        dispatch({ type: \"INIT\", payload: { isAuthenticated: true, user: data.user } });\n      } catch (err) {\n        console.error(err);\n        dispatch({ type: \"INIT\", payload: { isAuthenticated: false, user: null } });\n      }\n    })();\n  }, []);\n\n  // SHOW LOADER\n  if (!state.isInitialized) return <MatxLoading />;\n\n  return (\n    <AuthContext.Provider value={{ ...state, method: \"JWT\", login, logout, register }}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport default AuthContext;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}